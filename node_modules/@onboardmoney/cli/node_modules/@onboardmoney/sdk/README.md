# @onboardmoney/sdk

wrap ethereum in sexy

[![Version](https://img.shields.io/npm/v/@onboardmoney/sdk.svg)](https://npmjs.org/package/@onboardmoney/sdk)
[![Downloads/week](https://img.shields.io/npm/dw/@onboardmoney/sdk.svg)](https://npmjs.org/package/@onboardmoney/sdk)
[![License](https://img.shields.io/npm/l/@onboardmoney/sdk.svg)](https://github.com/onboardmoney/onboard.money/blob/master/package.json)

# Install

```sh-session
$ npm install @onboardmoney/sdk
```

```sh-session
$ yarn add @onboardmoney/sdk
```

# Initialize

```ts
import {
  App,
  TxBatchDto,
  TxRequestDto,
  TransactionReceipt,
} from '@onboardmoney/sdk';

const apiKey = 'ABCXYZ';
const network = 'mainnet' | 'ropsten' | 'rinkeby' | 'goerli' | 'kovan';
const onboardmoney = new App(apikey, `https://${network}.onboard.money`);
```

# App

```ts
// Fetch application ETH balance and address for gas payments
const { balance, relayAddress } = await onboardmoney.balance(): Promise<{ balance: string, relayAddress: string }>;
// { balance: 1.5, relayAddress: 0x1234 }

// Deploy onboard.money app wallet (one time action)
const { appAddress } = await onboardmoney.deploy(): Promise<{ appAddress: string }>;

// Create a new application user
const { userAddress } = await onboardmoney.createUser(): Promise<{ userAddress: string }>;

// Create user transaction batch
const txBatch: TxBatchDto = {
  txs: <TxRequestDto[]>[
    {
      from: userAddress, // required: user wallet address from which to send transaction (msg.sender)
      to: '0x1234', // required: destination address
      value: '1000000000000000000', // optional: amount of ETH to send in wei
      data: '0xabcd', // optional: smart contract calldata
    },
  ],
};

// Evaluate if a batch of user transactions would succeed
const { success } = await onboardmoney.evaluateBatch(txBatch): Promise<{ success: boolean }>;

// Send a batch of user transactions to the network
const txReceipt = await onboardmoney.sendBatch(): Promise<TransactionReceipt>;

// Query the current trust policy
const { policy } = await onboardmoney.getPolicy(): Promise<{ policy: string }>;

// Set a new trust policy
const newPolicy = 'self' | 'custodied' | 'multisig' // required: new trust policy
const signerAddress = '0x1234' // optional: application signer address (only for 'self' and 'multisig' trust policy)
await onboardmoney.updatePolicy(policy, signerAddress): Promise<void>;

// Create user transaction batch with 'self' or 'multisig' trust policy
// Helper methods in development. Contact team for support on how to craft required data.
const txBatch: TxBatchDto = {
  txs: <TxRequestDto[]>[
    {
      from: userAddress, // required: user address to send transaction from
      to: '0x1234', // required: destination address
      value: '1000000000000000000', // optional: amount of ETH to send in wei
      data: '0xabcd', // optional: smart contract calldata
      gasLimit: '100000', // required: gas limit permitted
      nonce: 15, // required: user wallet nonce
      userSig: ['0xabcd'], // required: user signature
    },
  ],
  gasPrice: '10000000000', // required: gas price in wei
  nonce: 10, // required: app wallet nonce
  appSig: ['0xabcd'], // required: application signature
};
```
